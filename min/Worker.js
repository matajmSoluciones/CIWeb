if(importScripts("module.config.js"),_MODULE&&_MODULE.forEach(function(a){importScripts(a)}),!_CONFIG)throw new Error("Este modulo requiere un fichero de configuración inicial cargado genere un archivo con la variable _CONFIG");if(!_CASCADE||!_WEIGHT)throw new Error("Este modulo requiere un fichero de set en cascada, en la configuración de la app cargue un modulo de pesos.");self.addEventListener("message",function(a){var b=JSVision.Feacture.LBP(a.data),c=[[],[]];JSVision.window.Pyramid.foreach(b[0],_CONFIG.recognition.pyramid,_CONFIG.canonical.width,_CONFIG.canonical.height,function(a){JSVision.window.foreach(a,_CONFIG.recognition.step,_CONFIG.canonical.width,_CONFIG.canonical.height,function(b,d){var e=Histograms(b.data,"GRAY");e.Normalize();var f=[Float32Array.from([1].concat(Array.from(e)))];if(JVCascade.Strong(f,_CASCADE)){var g=JVCascade.OneVsAll(f,_WEIGHT);if(g){var h=Morphology.Position.scale(d.x,d.y,a.width,a.height,_CONFIG.window.width,_CONFIG.window.height),i=Morphology.Position.scale(d.x+(d.width-1),d.y+(d.height-1),a.width,a.height,_CONFIG.ouput.width,_CONFIG.ouput.height),j={x:h.x,y:h.y,width:i.x-h.x+1,height:i.y-h.y+1,h:g[1]};c[g[0]].push(j)}}})});for(var d=0,e=c.length;d<e;d++)c[d]=JSVision.step.filter(c[d]);var f=new CustomEvent("success",{detail:c});self.dispatchEvent(f)}),self.addEventListener("success",function(a){self.postMessage(a.detail,[new ArrayBuffer(a.detail)])});